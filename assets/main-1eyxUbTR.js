import{t as W}from"./typeIcons-Cr3LCB7A.js";const t={listWrapper:document.querySelector(".list-wrapper"),firstButton:document.getElementById("firstButton"),prevButton:document.getElementById("prevButton"),nextButton:document.getElementById("nextButton"),lastButton:document.getElementById("lastButton"),pageInput:document.getElementById("pageInput"),pageInfo:document.getElementById("pageInfo"),goButton:document.querySelector(".pagination__button--go"),loader:document.querySelector(".loader-container"),filterSelect:document.getElementById("filterSelect"),sortSelect:document.getElementById("sortSelect"),searchInput:document.getElementById("search__input"),searchClear:document.getElementById("search__clear")},f=12;let o=1,y=1,p=[],d=[],h="id-asc",i="";t.loader.innerHTML=`
  <div class="loader-container">
    <div class="o-pokeball u-tada"></div>
    <p class="loader-text">Pokémons are coming...</p>
  </div>
`;document.body.appendChild(t.loader);A();async function A(){try{const e=localStorage.getItem("pokedexState");if(e){const n=JSON.parse(e);o=n.currentPage,h=n.currentSort,i=n.currentFilterType,t.searchInput.value=n.searchTerm||"",t.sortSelect.value=h,t.filterSelect.value=i,t.searchClear.style.display=n.searchTerm?"block":"none",await $(),I(),n.searchTerm?(d=p.filter(r=>{const a=u(r.url).toString(),l=r.name.toLowerCase();return a.includes(n.searchTerm.toLowerCase())||l.includes(n.searchTerm.toLowerCase())}),await N()):i?await w(i):await g()}else t.loader.style.display="flex",await $(),I(),await g();H()}catch(e){console.error("Error initializing app:",e)}finally{t.loader.style.display="none"}}function H(){t.firstButton.addEventListener("click",()=>P(1)),t.prevButton.addEventListener("click",()=>P(o-1)),t.nextButton.addEventListener("click",()=>P(o+1)),t.lastButton.addEventListener("click",()=>P(y)),t.goButton.addEventListener("click",M),t.pageInput.addEventListener("keypress",e=>{e.key==="Enter"&&M()}),t.filterSelect.addEventListener("change",R),t.searchInput.addEventListener("input",q),t.searchClear.addEventListener("click",z),t.sortSelect.addEventListener("change",()=>{h=t.sortSelect.value,I()})}async function g(){try{t.listWrapper.innerHTML="",t.loader.style.display="flex";const e=i?d:p;y=Math.ceil(e.length/f);const n=(o-1)*f,r=n+f,a=e.slice(n,r),l=await Promise.all(a.map(m=>k(u(m.url))));E(a,l),L()}catch(e){console.error("Error loading pokemons:",e)}finally{t.loader.style.display="none"}}function E(e,n){t.listWrapper.innerHTML="",t.listWrapper.style.opacity="0";const r=document.createDocumentFragment(),a=[];e.forEach((l,m)=>{if(n[m]){const v=u(l.url),{card:c,imageLoadPromise:S}=O(l,v,n[m]);a.push(S),r.appendChild(c)}}),t.listWrapper.appendChild(r),Promise.all(a).then(()=>{t.listWrapper.style.opacity="1"})}function O(e,n,r){if(!r)return document.createElement("div");const a=document.createElement("div");a.className="card",a.dataset.id=n;const m=r.types.map(s=>s.type.name).map(s=>`
    <div class="card__type ${s}">
      <img src="${W[s]}" title="${s}" alt="${s}" />
      <div>${s}</div>
    </div>
  `).join("");a.innerHTML=`
    <div class="card__id">#${String(n).padStart(4,"0")}</div>
    <div class="card__img"></div>
    <div class="card__name">${J(e.name)}</div>
    <div class="card__types">${m}</div>
  `;const v=(s,F)=>{var B,C,T,_;return s!=null&&s.sprites?((C=(B=s.sprites.other)==null?void 0:B.home)==null?void 0:C.front_default)||((_=(T=s.sprites.other)==null?void 0:T["official-artwork"])==null?void 0:_.front_default)||s.sprites.front_default:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${F}.png`},c=document.createElement("img");c.src=v(r,n),c.alt=e.name,c.loading="lazy",c.onerror=()=>{c.src=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${n}.png`,c.onerror=()=>{c.src=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${n}.png`}};const S=new Promise(s=>{c.onload=()=>{c.classList.add("loaded"),s()},c.onerror=()=>s()});return a.querySelector(".card__img").appendChild(c),a.addEventListener("click",()=>{K(n)}),{card:a,imageLoadPromise:S}}async function k(e){try{return await(await fetch(`https://pokeapi.co/api/v2/pokemon/${e}`)).json()}catch(n){return console.error(`Failed to fetch Pokemon data for ID ${e}:`,n),null}}function u(e){const n=e.split("/").filter(Boolean);return parseInt(n[n.length-1],10)}async function P(e){e=Math.max(1,Math.min(e,y)),e!==o&&(o=e,i?await w(i):await g())}function M(){const e=parseInt(t.pageInput.value,10);!isNaN(e)&&e>=1&&e<=y?P(e):t.pageInput.value=o}function L(){t.pageInfo.textContent=`Page ${o} of ${y}`,t.pageInput.value=o,t.firstButton.disabled=o===1,t.prevButton.disabled=o===1,t.nextButton.disabled=o===y,t.lastButton.disabled=o===y}function J(e){return e.charAt(0).toUpperCase()+e.slice(1)}function q(){const e=t.searchInput.value.toLowerCase().trim();e?j(e):x(),t.searchClear.style.display=e?"block":"none"}function x(){d=[],o=1,t.searchInput.value="",t.searchClear.style.display="none",g();const e=localStorage.getItem("pokedexState");if(e){const n=JSON.parse(e);n.searchTerm="",localStorage.setItem("pokedexState",JSON.stringify(n))}}function j(e){d=p.filter(n=>{const r=u(n.url).toString(),a=n.name.toLowerCase();return r.includes(e)||a.includes(e)}),y=Math.ceil(d.length/f),o=1,d.length===0?b():N()}function b(){t.listWrapper.innerHTML=`
    <div class="no-results">No Pokémon found</div>
  `}async function N(){t.listWrapper.innerHTML="",t.loader.style.display="flex";try{const e=(o-1)*f,n=e+f,r=d.slice(e,n),a=await Promise.all(r.map(l=>k(u(l.url))));E(r,a),L()}catch(e){console.error("Error displaying filtered pokemons:",e)}finally{t.loader.style.display="none"}}function z(){t.searchInput.value="",t.searchClear.style.display="none",x()}function I(){h==="id-asc"?p.sort((e,n)=>u(e.url)-u(n.url)):h==="id-desc"?p.sort((e,n)=>u(n.url)-u(e.url)):h==="name-asc"?p.sort((e,n)=>e.name.localeCompare(n.name)):h==="name-desc"&&p.sort((e,n)=>n.name.localeCompare(e.name)),g()}async function R(){i=t.filterSelect.value,U(),i===""?G():await w(i)}function U(){const e={currentPage:o,currentSort:h,currentFilterType:i,searchTerm:t.searchInput.value};localStorage.setItem("pokedexState",JSON.stringify(e))}async function w(e){try{t.listWrapper.innerHTML="",t.loader.style.display="flex";const n=await Promise.all(p.map(r=>k(u(r.url))));if(d=p.filter((r,a)=>{const l=n[a];return l&&l.types.some(m=>m.type.name===e)}),y=Math.ceil(d.length/f),o=1,d.length===0)b();else{const r=(o-1)*f,a=r+f,l=d.slice(r,a),m=await Promise.all(l.map(v=>k(u(v.url))));E(l,m)}L()}catch(n){console.error("Error filtering pokemons by type:",n)}finally{t.loader.style.display="none"}}function G(){i="",d=[],o=1,g()}async function $(){try{p=(await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=11000")).json()).results.filter(r=>u(r.url)<1e4),y=Math.ceil(p.length/f)}catch(e){throw console.error("Error fetching all pokemons:",e),e}}function K(e){const n={currentPage:o,currentSort:h,currentFilterType:i,searchTerm:t.searchInput.value,filteredPokemons:i||t.searchInput.value?d:null};localStorage.setItem("pokedexState",JSON.stringify(n)),localStorage.setItem("currentPokemonID",e),window.location.href=`details.html?id=${e}`}
