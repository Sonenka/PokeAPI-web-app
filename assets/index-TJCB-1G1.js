(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const g of s.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&a(g)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const r={listWrapper:document.querySelector(".list-wrapper"),firstButton:document.getElementById("firstButton"),prevButton:document.getElementById("prevButton"),nextButton:document.getElementById("nextButton"),lastButton:document.getElementById("lastButton"),pageInput:document.getElementById("pageInput"),pageInfo:document.getElementById("pageInfo"),goButton:document.querySelector(".pagination__button--go"),loader:document.querySelector(".loader-container"),filterSelect:document.getElementById("filterSelect"),sortSelect:document.getElementById("sortSelect"),searchInput:document.getElementById("search__input"),searchClear:document.getElementById("search__clear")},f=12;let l=1,y=1,m=[],u=[],h="id-asc",c="";r.loader.innerHTML=`
  <div class="loader-container">
    <div class="o-pokeball u-tada"></div>
    <p class="loader-text">Pokémons are coming...</p>
  </div>
`;document.body.appendChild(r.loader);F();async function F(){try{const e=localStorage.getItem("pokedexState");if(e){const t=JSON.parse(e);l=t.currentPage,h=t.currentSort,c=t.currentFilterType,r.searchInput.value=t.searchTerm||"",r.sortSelect.value=h,r.filterSelect.value=c,r.searchClear.style.display=t.searchTerm?"block":"none",await M(),I(),t.searchTerm?(u=m.filter(o=>{const a=p(o.url).toString(),n=o.name.toLowerCase();return a.includes(t.searchTerm.toLowerCase())||n.includes(t.searchTerm.toLowerCase())}),await x()):c?await w(c):await v()}else r.loader.style.display="flex",await M(),I(),await v();A()}catch(e){console.error("Error initializing app:",e)}finally{r.loader.style.display="none"}}function A(){r.firstButton.addEventListener("click",()=>P(1)),r.prevButton.addEventListener("click",()=>P(l-1)),r.nextButton.addEventListener("click",()=>P(l+1)),r.lastButton.addEventListener("click",()=>P(y)),r.goButton.addEventListener("click",b),r.pageInput.addEventListener("keypress",e=>{e.key==="Enter"&&b()}),r.filterSelect.addEventListener("change",z),r.searchInput.addEventListener("input",q),r.searchClear.addEventListener("click",j),r.sortSelect.addEventListener("change",()=>{h=r.sortSelect.value,I()})}async function v(){try{r.listWrapper.innerHTML="",r.loader.style.display="flex";const e=c?u:m;y=Math.ceil(e.length/f);const t=(l-1)*f,o=t+f,a=e.slice(t,o),n=await Promise.all(a.map(s=>S(p(s.url))));L(a,n),E()}catch(e){console.error("Error loading pokemons:",e)}finally{r.loader.style.display="none"}}function L(e,t){r.listWrapper.innerHTML="",r.listWrapper.style.opacity="0";const o=document.createDocumentFragment(),a=[];e.forEach((n,s)=>{if(t[s]){const g=p(n.url),{card:d,imageLoadPromise:k}=W(n,g,t[s]);a.push(k),o.appendChild(d)}}),r.listWrapper.appendChild(o),Promise.all(a).then(()=>{r.listWrapper.style.opacity="1"})}function W(e,t,o){if(!o)return document.createElement("div");const a=document.createElement("div");a.className="card",a.dataset.id=t;const s=o.types.map(i=>i.type.name).map(i=>`
    <div class="card__type ${i}">
      <img src="public/img/types/${i}.svg" title="${i}" alt="${i}"/>
      <div>${i}</div>
    </div>
  `).join("");a.innerHTML=`
    <div class="card__id">#${String(t).padStart(4,"0")}</div>
    <div class="card__img"></div>
    <div class="card__name">${H(e.name)}</div>
    <div class="card__types">${s}</div>
  `;const g=(i,O)=>{var B,C,T,_;return i!=null&&i.sprites?((C=(B=i.sprites.other)==null?void 0:B.home)==null?void 0:C.front_default)||((_=(T=i.sprites.other)==null?void 0:T["official-artwork"])==null?void 0:_.front_default)||i.sprites.front_default:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${O}.png`},d=document.createElement("img");d.src=g(o,t),d.alt=e.name,d.loading="lazy",d.onerror=()=>{d.src=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${t}.png`,d.onerror=()=>{d.src=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${t}.png`}};const k=new Promise(i=>{d.onload=()=>{d.classList.add("loaded"),i()},d.onerror=()=>i()});return a.querySelector(".card__img").appendChild(d),a.addEventListener("click",()=>{G(t)}),{card:a,imageLoadPromise:k}}async function S(e){try{return await(await fetch(`https://pokeapi.co/api/v2/pokemon/${e}`)).json()}catch(t){return console.error(`Failed to fetch Pokemon data for ID ${e}:`,t),null}}function p(e){const t=e.split("/").filter(Boolean);return parseInt(t[t.length-1],10)}async function P(e){e=Math.max(1,Math.min(e,y)),e!==l&&(l=e,c?await w(c):await v())}function b(){const e=parseInt(r.pageInput.value,10);!isNaN(e)&&e>=1&&e<=y?P(e):r.pageInput.value=l}function E(){r.pageInfo.textContent=`Page ${l} of ${y}`,r.pageInput.value=l,r.firstButton.disabled=l===1,r.prevButton.disabled=l===1,r.nextButton.disabled=l===y,r.lastButton.disabled=l===y}function H(e){return e.charAt(0).toUpperCase()+e.slice(1)}function q(){const e=r.searchInput.value.toLowerCase().trim();e?J(e):N(),r.searchClear.style.display=e?"block":"none"}function N(){u=[],l=1,r.searchInput.value="",r.searchClear.style.display="none",v();const e=localStorage.getItem("pokedexState");if(e){const t=JSON.parse(e);t.searchTerm="",localStorage.setItem("pokedexState",JSON.stringify(t))}}function J(e){u=m.filter(t=>{const o=p(t.url).toString(),a=t.name.toLowerCase();return o.includes(e)||a.includes(e)}),y=Math.ceil(u.length/f),l=1,u.length===0?$():x()}function $(){r.listWrapper.innerHTML=`
    <div class="no-results">No Pokémon found</div>
  `}async function x(){r.listWrapper.innerHTML="",r.loader.style.display="flex";try{const e=(l-1)*f,t=e+f,o=u.slice(e,t),a=await Promise.all(o.map(n=>S(p(n.url))));L(o,a),E()}catch(e){console.error("Error displaying filtered pokemons:",e)}finally{r.loader.style.display="none"}}function j(){r.searchInput.value="",r.searchClear.style.display="none",N()}function I(){h==="id-asc"?m.sort((e,t)=>p(e.url)-p(t.url)):h==="id-desc"?m.sort((e,t)=>p(t.url)-p(e.url)):h==="name-asc"?m.sort((e,t)=>e.name.localeCompare(t.name)):h==="name-desc"&&m.sort((e,t)=>t.name.localeCompare(e.name)),v()}async function z(){c=r.filterSelect.value,R(),c===""?U():await w(c)}function R(){const e={currentPage:l,currentSort:h,currentFilterType:c,searchTerm:r.searchInput.value};localStorage.setItem("pokedexState",JSON.stringify(e))}async function w(e){try{r.listWrapper.innerHTML="",r.loader.style.display="flex";const t=await Promise.all(m.map(o=>S(p(o.url))));if(u=m.filter((o,a)=>{const n=t[a];return n&&n.types.some(s=>s.type.name===e)}),y=Math.ceil(u.length/f),l=1,u.length===0)$();else{const o=(l-1)*f,a=o+f,n=u.slice(o,a),s=await Promise.all(n.map(g=>S(p(g.url))));L(n,s)}E()}catch(t){console.error("Error filtering pokemons by type:",t)}finally{r.loader.style.display="none"}}function U(){c="",u=[],l=1,v()}async function M(){try{m=(await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=11000")).json()).results.filter(o=>p(o.url)<1e5),y=Math.ceil(m.length/f)}catch(e){throw console.error("Error fetching all pokemons:",e),e}}function G(e){const t={currentPage:l,currentSort:h,currentFilterType:c,searchTerm:r.searchInput.value,filteredPokemons:c||r.searchInput.value?u:null};localStorage.setItem("pokedexState",JSON.stringify(t)),localStorage.setItem("currentPokemonID",e),window.location.href=`details.html?id=${e}`}
