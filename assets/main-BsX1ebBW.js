import{m as n,t as M}from"./typeIcons-CdbB5jcy.js";const e={allPokemons:[],filteredPokemons:[],currentPage:1,itemsPerPage:12,sortOption:"id-asc",currentFilterType:"",searchTerm:""};function _(t){const r={currentPage:e.currentPage,currentSort:e.sortOption,currentFilterType:e.currentFilterType||"",searchTerm:n.searchInput.value.trim()};localStorage.setItem("pokedexState",JSON.stringify(r)),localStorage.setItem("currentPokemonID",t),window.location.href=`details.html?id=${t}`}const m=12;async function S(){try{const r=await(await fetch("https://pokeapi.co/api/v2/pokemon?limit=10000")).json();e.allPokemons=r.results.filter(o=>s(o.url)<1e4),console.log("Pokemons loaded:",e.allPokemons),e.totalPages=Math.ceil(e.allPokemons.length/m)}catch(t){throw console.error("Error fetching all pokemons:",t),t}}async function P(t){try{return await(await fetch(`https://pokeapi.co/api/v2/pokemon/${t}`)).json()}catch(r){return console.error(`Failed to fetch Pokemon data for ID ${t}:`,r),null}}function s(t){const r=t.split("/").filter(Boolean);return parseInt(r[r.length-1],10)}function $(t){return t.charAt(0).toUpperCase()+t.slice(1)}async function f(){try{n.loader.style.display="flex";const t=e.searchTerm||e.currentFilterType?e.filteredPokemons:e.allPokemons;e.totalPages=Math.ceil(t.length/m),e.currentPage=Math.min(e.currentPage,e.totalPages||1);const r=t.slice((e.currentPage-1)*m,e.currentPage*m),o=await Promise.all(r.map(a=>P(s(a.url))));B(r,o)}finally{n.loader.style.display="none"}}function B(t,r){n.listWrapper.innerHTML="",n.listWrapper.style.opacity="0";const o=document.createDocumentFragment(),a=[];t.forEach((i,p)=>{if(r[p]){const g=s(i.url),{card:c,imageLoadPromise:y}=x(i,g,r[p]);a.push(y),o.appendChild(c)}}),n.listWrapper.appendChild(o),Promise.all(a).then(()=>{n.listWrapper.style.opacity="1"})}function x(t,r,o){if(!o)return document.createElement("div");const a=document.createElement("div");a.className="card",a.dataset.id=r;const p=o.types.map(l=>l.type.name).map(l=>`
    <div class="card__type ${l}">
      <img src="${M[l]}" title="${l}" alt="${l}" />
      <div>${l}</div>
    </div>
  `).join("");a.innerHTML=`
    <div class="card__id">#${String(r).padStart(4,"0")}</div>
    <div class="card__img"></div>
    <div class="card__name">${$(t.name)}</div>
    <div class="card__types">${p}</div>
  `;const g=(l,C)=>{var T,b,L,w;return l!=null&&l.sprites?((b=(T=l.sprites.other)==null?void 0:T.home)==null?void 0:b.front_default)||((w=(L=l.sprites.other)==null?void 0:L["official-artwork"])==null?void 0:w.front_default)||l.sprites.front_default:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${C}.png`},c=document.createElement("img");c.src=g(o,r),c.alt=t.name,c.loading="lazy",c.onerror=()=>{c.src=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${r}.png`,c.onerror=()=>{c.src=`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${r}.png`}};const y=new Promise(l=>{c.onload=()=>{c.classList.add("loaded"),l()},c.onerror=()=>l()});return a.querySelector(".card__img").appendChild(c),a.addEventListener("click",()=>{_(r)}),{card:a,imageLoadPromise:y}}function N(){n.pageInfo.textContent=`Page ${e.currentPage} of ${e.totalPages}`,n.pageInput.value=e.currentPage,n.firstButton.disabled=e.currentPage===1,n.prevButton.disabled=e.currentPage===1,n.nextButton.disabled=e.currentPage===e.totalPages,n.lastButton.disabled=e.currentPage===e.totalPages,n.mobileFirstButton.disabled=e.currentPage===1,n.mobilePrevButton.disabled=e.currentPage===1,n.mobileNextButton.disabled=e.currentPage===e.totalPages,n.mobileLastButton.disabled=e.currentPage===e.totalPages,[n.firstButton,n.prevButton,n.nextButton,n.lastButton,n.mobileFirstButton,n.mobilePrevButton,n.mobileNextButton,n.mobileLastButton].forEach(r=>{r.disabled?(r.classList.add("disabled"),r.setAttribute("aria-disabled","true")):(r.classList.remove("disabled"),r.setAttribute("aria-disabled","false"))})}async function A(){n.listWrapper.innerHTML="",n.loader.style.display="flex";try{const t=(e.currentPage-1)*m,r=t+m,o=e.filteredPokemons.slice(t,r),a=await Promise.all(o.map(i=>P(s(i.url))));B(o,a),N()}catch(t){console.error("Error displaying filtered pokemons:",t)}finally{n.loader.style.display="none"}}function O(){n.listWrapper.innerHTML=`
    <div class="no-results">No Pokémon found</div>
  `}async function d(t){t=Math.max(1,Math.min(t,e.totalPages)),t!==e.currentPage&&(e.currentPage=t,await f())}async function W(){const t=n.filterSelect.value;if(e.currentFilterType=t,!e.allPokemons.length){console.warn("Pokemons are not yet loaded.");return}t===""?k():await E(t)}async function E(t){try{if(n.listWrapper.innerHTML="",n.loader.style.display="flex",!t)e.filteredPokemons=[],e.currentFilterType="";else{const r=await Promise.all(e.allPokemons.map(o=>P(s(o.url))));e.filteredPokemons=e.allPokemons.filter((o,a)=>{const i=r[a];return i&&i.types.some(p=>p.type.name===t)}),e.currentFilterType=t,v()}e.currentPage=1,await f()}catch(r){console.error("Error filtering pokemons by type:",r)}finally{n.loader.style.display="none"}}function k(){console.log("Resetting type filter, showing all pokemons."),e.currentFilterType="",e.filteredPokemons=[...e.allPokemons],v(),e.currentPage=1,f()}function v(){const t=e.filteredPokemons.length>0?e.filteredPokemons:e.allPokemons;switch(e.sortOption){case"id-asc":t.sort((r,o)=>s(r.url)-s(o.url));break;case"id-desc":t.sort((r,o)=>s(o.url)-s(r.url));break;case"name-asc":t.sort((r,o)=>r.name.localeCompare(o.name));break;case"name-desc":t.sort((r,o)=>o.name.localeCompare(r.name));break}e.filteredPokemons.length>0?e.filteredPokemons=t:e.allPokemons=t}function H(){const t=n.searchInput.value.toLowerCase().trim();e.searchTerm=t,n.searchClear.style.display=t?"block":"none",t?R(t):I()}function R(t){const r=e.currentFilterType?e.filteredPokemons.length>0?e.filteredPokemons:e.allPokemons.filter(o=>z(o,e.currentFilterType)):e.allPokemons;e.filteredPokemons=r.filter(o=>{const a=s(o.url).toString(),i=o.name.toLowerCase();return a.includes(t)||i.includes(t)}),j()}function j(){e.totalPages=Math.ceil(e.filteredPokemons.length/m),e.currentPage=1,e.filteredPokemons.length===0?O():A()}async function I(){e.searchTerm="",n.searchInput.value="",n.searchClear.style.display="none",e.currentFilterType?(e.filteredPokemons=e.allPokemons.filter(t=>{const r=s(t.url);return u.has(r)?u.get(r).includes(e.currentFilterType):!0}),await G()):e.filteredPokemons=[...e.allPokemons],v(),e.currentPage=1,f()}const u=new Map;async function z(t,r){const o=s(t.url);if(!u.has(o)){const a=await P(o);u.set(o,(a==null?void 0:a.types.map(i=>i.type.name))||[])}return u.get(o).includes(r)}function U(){n.searchInput.value="",n.searchClear.style.display="none",I(),n.listWrapper.style.opacity="0",setTimeout(()=>{n.listWrapper.style.opacity="1"},150)}async function G(){const t=e.filteredPokemons.filter(r=>{const o=s(r.url);return!u.has(o)});await Promise.all(t.map(async r=>{const o=s(r.url),a=await P(o);u.set(o,a.types.map(i=>i.type.name))})),e.filteredPokemons=e.filteredPokemons.filter(r=>{var a;const o=s(r.url);return(a=u.get(o))==null?void 0:a.includes(e.currentFilterType)})}function h(){const t=n.sortSelect.value;e.sortOption=t;const r=e.filteredPokemons.length>0?e.filteredPokemons:e.allPokemons;switch(t){case"id-asc":r.sort((o,a)=>s(o.url)-s(a.url));break;case"id-desc":r.sort((o,a)=>s(a.url)-s(o.url));break;case"name-asc":r.sort((o,a)=>o.name.localeCompare(a.name));break;case"name-desc":r.sort((o,a)=>a.name.localeCompare(o.name));break}e.filteredPokemons.length>0?e.filteredPokemons=r:e.allPokemons=r,e.currentPage=1,f()}function J(){n.firstButton.addEventListener("click",()=>d(1)),n.prevButton.addEventListener("click",()=>d(e.currentPage-1)),n.nextButton.addEventListener("click",()=>d(e.currentPage+1)),n.lastButton.addEventListener("click",()=>d(e.totalPages)),n.mobileFirstButton.addEventListener("click",()=>d(1)),n.mobilePrevButton.addEventListener("click",()=>d(e.currentPage-1)),n.mobileNextButton.addEventListener("click",()=>d(e.currentPage+1)),n.mobileLastButton.addEventListener("click",()=>d(e.totalPages)),n.goButton.addEventListener("click",F),n.pageInput.addEventListener("keypress",t=>{t.key==="Enter"&&F()}),n.filterSelect.addEventListener("change",W),n.searchInput.addEventListener("input",H),n.searchClear.addEventListener("click",U),n.sortSelect.addEventListener("change",()=>{e.currentSort=n.sortSelect.value,h()})}function F(){const t=parseInt(n.pageInput.value,10);!isNaN(t)&&t>=1&&t<=e.totalPages?d(t):n.pageInput.value=e.currentPage}n.loader.innerHTML=`
  <div class="loader-container">
    <div class="o-pokeball u-tada"></div>
    <p class="loader-text">Pokémons are coming...</p>
  </div>
`;document.body.appendChild(n.loader);async function q(){try{const t=localStorage.getItem("pokedexState");if(n.filterSelect.value="",e.currentFilterType="",t){const r=JSON.parse(t);n.searchInput.value=r.searchTerm||"",n.sortSelect.value=r.currentSort||"id-asc",r.currentFilterType&&(n.filterSelect.value=r.currentFilterType,e.currentFilterType=r.currentFilterType),await S(),h(),r.searchTerm||(r.currentFilterType?await E(r.currentFilterType):k())}else n.loader.style.display="flex",await S(),h(),k();J()}catch(t){console.error("Error initializing app:",t)}finally{n.loader.style.display="none"}}q();
